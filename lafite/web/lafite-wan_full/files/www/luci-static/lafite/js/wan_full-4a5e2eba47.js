(function(){"use strict";var n;n=angular.module("pandorabox.pages"),n.register.controller("WanFullController",["$scope","$UCI",function(n,e){var a,t,r;null==n.wan&&(n.wan={}),n.protos=["pppoe","static","dhcp"],e.$sync(["network","wan"]).then(function(){var a,t;if(n.wan=angular.copy(e.network.wan),angular.isUndefined(n.wan.mtu)&&(n.wan.mtu=0),angular.isUndefined(n.wan.peerdns)&&(n.wan.peerdns="1"),angular.isUndefined(n.wan.dns)||"1"===n.wan.peerdns)n.wan.dns_text=["0.0.0.0","0.0.0.0"];else{for(t=[],a=n.wan.dns,angular.isDefined(a)&&a.length>0&&(t=a.split(" "));t.length<2;)t.push("0.0.0.0");n.wan.dns_text=t}}),t={dhcp:[],pppoe:["username","password"],"static":["ipaddr","netmask","gateway"]},r={dhcp:[],pppoe:["username","password"],"static":["ipaddr","netmask","gateway"]},a=["proto","macaddr","dns","peerdns","mtu"],n.submit=function(s){var d,w,p,o,l,i,u,g,f,c,m,h,$,x,y,D,_,k,v,U;if(e.$revert("network","wan"),D=n.wan.mtu,angular.isDefined(D)?(D=parseInt(D,10),D<0&&(D=0),D>=1500&&(D="pppoe"===n.wan.proto?1492:1500)):D=0,n.wan.mtu=D,"0"===n.wan.peerdns){for(l="",_=n.wan.dns_text,i=0,h=_.length;i<h;i++)u=_[i],"0.0.0.0"!==u&&(l.length>0&&(l+=" "),l+=u);l.length>0?n.wan.dns=l:n.wan.peerdns="1"}for("1"===n.wan.peerdns&&"static"===n.wan.proto&&(n.wan.peerdns="0",n.wan.dns=n.wan.gateway,n.wan.dns_text[0]=n.wan.gateway,n.wan.dns_text[1]="0.0.0.0"),d={},v=a.concat(r[n.wan.proto]),g=0,$=v.length;g<$;g++)k=v[g],/_text/.test(k)||(U=n.wan[k],e[s].wan[k]!==U&&(d[k]=U));for(c in t)if(U=t[c],n.wan.proto!==c)for(f=0,x=U.length;f<x;f++)u=U[f],p={},p[u]="del",angular.isDefined(e[s].wan[u])&&e.$del(s,"wan",p);if(0===d.mtu&&(angular.isDefined(e[s].wan.mtu)&&e.$del(s,"wan",{mtu:"del"}),delete d.mtu),"1"===d.peerdns)for(w=["dns","peerdns"],m=0,y=w.length;m<y;m++)o=w[m],p={},p[o]="del",angular.isDefined(e[s].wan[o])&&e.$del(s,"wan",p),angular.isDefined(d[o])&&delete d[o];return e.$set(s,"wan",d),!0}}])}).call(this);