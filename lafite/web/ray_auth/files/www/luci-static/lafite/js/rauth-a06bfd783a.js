(function(){"use strict";var n;n=angular.module("pandorabox.pages"),n.register.controller("RauthController",["$scope","$rootScope","$http","$location","$interval","Status","$UCI",function(n,t,i,l,r,o,a){var u;n.display=!1,function(){var t;t=r(function(){var i,l;return null!=o.board&&(null!=o.board.uuid&&(l=null!=(i=window.localStorage.getItem("user"))?i:"{ }",l=JSON.parse(l),r.cancel(t),null==l[o.board.uuid]?(n.display=!0,!1):(o.login=l[o.board.uuid],a.$command(["GET date +'%s'"],"now").then(function(t){var i,l,r;return i=+t.commands[0].content[0],o.login.date=null!=(l=o.login.date)?l:0,o.login.limit=null!=(r=o.login.limit)?r:0,o.login.date+o.login.limit>i?u():n.display=!0})["catch"](function(){n.display=!0}))))},500,10)}(),n.loginErr=!1,n.user={username:{visibility:!1,text:"root"},password:{visibility:!0,text:""}},n.clearFlag=function(){n.loginErr=!1},n.submit=function(){var t,l;return t="/cgi-bin/luci/pbr/auth",l=null,function(){return null==l&&(l=i.post(t,{action:"login",username:n.user.username.text,password:n.user.password.text}).success(function(t){var i,r;return l=null,"ok"!==t.status?void(n.loginErr=!0):(o.login={date:t.date,limit:+t.limit,sysauth:t.sysauth},r=null!=(i=window.localStorage.getItem("user"))?i:"{ }",r=JSON.stringify(r),angular.isObject(r)||(r={}),r[o.board.uuid]=o.login,window.localStorage.setItem("user",JSON.stringify(r)),void u())}).error(function(){l=null}),!0)}}(),u=function(){return null!=o.main.pre?l.path("/pages/"+o.main.pre):l.path("/")}}])}).call(this);