(function(){"use strict";var e;e=angular.module("pandorabox.pages"),e.register.controller("WirelessBasicController",["$scope","$UCI","WirelessEncryption",function(e,s,l){var i;null==e.wireless&&(e.wireless={}),e.list={},s.$sync(["wireless"]).then(function(){var l,t,r,n,o,a,d,c,w,h,u;for(n=[],c=Object.keys(s.wireless).sort(),o=0,w=c.length;o<w;o++)if(d=c[o],!/^cfg/.test(d))for(e.wireless[d]=angular.copy(s.wireless[d]),n.push("GET iwinfo "+d+" freqlist"),n.push("GET iwinfo "+d+" htmodelist"),a=0,h=c.length;a<h;a++)u=c[a],/^cfg/.test(u)&&s.wireless[u].device===d&&(e.wireless[u]=angular.copy(s.wireless[u]),null==(l=e.wireless[u]).disabled&&(l.disabled="0"),"0"===e.wireless[u].disabled?null==(t=e.wireless[u]).enabled&&(t.enabled=!0):null==(r=e.wireless[u]).enabled&&(r.enabled=!1));i(n)}),i=function(l){s.$command(l,"now").then(function(s){var l,i,t,r,n,o,a,d,c,w,h,u,f;for(w=s.commands,t=0,a=w.length;t<a;t++)if(c=w[t],/(freq|htmode)list/.test(c.command))for(i=c.command.match(/(\w+) (freq|htmode)list$/)[1],null==(l=e.list)[i]&&(l[i]={freqlist:[],htmodelist:[]}),h=c.content,n=0,d=h.length;n<d;n++)r=h[n],/unknown/.test(r)||(u=r.match(/^[*\s]+(\w.+ (\d+).+$)/),u?e.list[i].freqlist.push({key:u[1],val:u[2]}):(u=r.match(/(\w+)/g),u&&(e.list[i].htmodelist=function(){var e;e=[];for(o in u)f=u[o],/\d/.test(o)&&e.push(f);return e}())))})},e.encryption=l,e.submit=function(l){var i,t,r,n,o,a,d,c;i={},e.wireless[l].enabled?e.wireless[l].disabled="0":e.wireless[l].disabled="1",a=e.wireless[l];for(n in a)c=a[n],"enabled"!==n&&s.wireless[l][n]!==c&&(i[n]=c);s.$revert("wireless",l),s.$set("wireless",l,i),i={},t=s.wireless[l].device,d=e.wireless[t];for(n in d)c=d[n],"enabled"!==n&&s.wireless[t][n]!==c&&(i[n]=c);return null!=i.channel&&(o=e.list[t].htmodelist,"165"===i.channel?i.htmode="HT20":(r=s.$Native.wireless[t].htmode,"HT20"===r?i.htmode=o[o.length-1]:i.htmode=r)),s.$revert("wireless",t),s.$set("wireless",t,i),!0}}]),e.register.value("WirelessEncryption",["none","psk","psk2"])}).call(this);